# 集合框架总结

## 概览

### 简介

图片说明：

- 虚线标识实现、实线标识继承
- 绿色背景是具体实现类,粉色背景是抽象接口
- 左上角`legacy`是遗留的,线程安全的集合
- ⭕圈圈颜色,标识集合底层实现。是数组、链表、二叉堆、哈希表还是红黑树

![img](集合框架总结.assets/java_collections_overview.png)



容器，就是可以容纳其他Java对象的对象。*Java Collections Framework(JCF)*为Java开发者提供了通用的容器，其始于JDK 1.2，优点是:

- 降低编程难度
- 提高程序性能
- 提高API间的互操作性
- 降低学习难度
- 降低设计和实现相关API的难度
- 增加程序的重用性

集合框架主要分为Collection接口和Map接口。

Java容器里只能放对象，对于基本类型(int, long, float, double等)，需要将其包装成对象类型后(Integer, Long, Float, Double等)才能放到容器里。很多时候拆包装和解包装能够自动完成。这虽然会导致额外的性能和空间开销，但简化了设计和编程。



### collection

- list接口
  - ArrayList基于动态数组实现,支持随机访问
  - LinkedList基于双向链表实现,只能顺序访问、不支持随机访问,但对插入友好
  - Vector  和ArayList相似,但是它线程安全(使用Synchronized保证)
- set接口
  - HashSet    基于HashMap实现
  - LnkedHashSet   基于双线链表+HashSet实现
  - TreeSet     基于红黑树实现
- queue接口
  - LinkedList   
  - PriorityQueue  优先级队列,基于二叉堆实现

### Map

- HashTable  和HashMap类似,但线程安全。遗留类,不应该被使用,没有线程安全的情况下使用HashMap,有线程安全的情况下使用ConcurrentHashMap。因为CHM引入了分段锁效率较高。

- HashMap  哈希表

- LinkedHashMap  双向链表+HashMap  牺牲空间保证Map节点的有序性。插入顺序和最近

- TreeMap 基于红黑树实现

  

## Iterable-Collection

### List

#### ArrayList

##### 继承关系

![image-20230310155855769](集合框架总结.assets/image-20230310155855769.png)

- Clonable

  > 实现此接口才可以重写Object的Clone()方法,利用Array.copy和System.ArrayCopy拷贝,这是个浅拷贝。
  >
  > 会将模数modCount置零,且拷贝时会忽略数组中的空对象

- Serializable

  > 实现此接口对象才可以序列化传输。JDK提供的ObjectOutputStream、ObjectInputStream。
  >
  > 序列化时会保存集合的size，并且忽略数组中的空对象,反序列化先读取size然后循环读取对象放到数组中

- RandomAccess

  > 标志性接口,没作用,表示支持随机访问。Vector也实现了此接口

- AbstractList

##### 底层及结构

> 对象数组Object[],可接受任意类型的对象。

##### 属性和方法

###### 属性：

> - 底层结构：对象数组，Object类型可接受任意类型元素
> - 对象数组使用transient修饰,不会参与序列化
> - size：数组元素个数,不是数组大小

```java
//序列号
private static final long serialVersionUID = 8683452581122892189L;
//默认初始容量
private static final int DEFAULT_CAPACITY = 10;
//空对象数组，初始化ArrayList如果size等于0的话，则初始化为该空数组
private static final Object[] EMPTY_ELEMENTDATA = {};
//默认空对象数组，ArrayList无参构造初锁始化的空数组
private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};
//对象数组,ArrayList底层结构,集合成员都存储在此
transient Object[] elementData; 
//元素个数、注意不是数组长度
private int size;
```

###### 构造函数

可定义容量,可拷贝

```java
public ArrayList(int initialCapacity);
public ArrayList();
public ArrayList(Collection<? extends E> c);
```

> 常用操作：

```java
new ArrayList(Arrays.asList(1,2,3));
```

###### 扩容

- ensureCapacity(int minCapacity);是一个public方法，

```java
public void ensureCapacity(int minCapacity);
private Object[] grow(int minCapacity);
```









































